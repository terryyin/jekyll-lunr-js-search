/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */
!function(t,e){if("object"==typeof exports&&exports)e(exports);else{var r={};e(r),"function"==typeof define&&define.amd?define(r):t.Mustache=r}}(this,function(t){function e(t,e){return d.call(t,e)}function r(t){return!e(f,t)}function n(t){return"function"==typeof t}function i(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function s(t){return String(t).replace(/[&<>"'\/]/g,function(t){return g[t]})}function o(t){if(!y(t)||2!==t.length)throw new Error("Invalid tags: "+t);return[new RegExp(i(t[0])+"\\s*"),new RegExp("\\s*"+i(t[1]))]}function a(e,n){function s(){if(E&&!Q)for(;k.length;)delete A[k.pop()];else k=[];E=!1,Q=!1}n=n||t.tags,e=e||"","string"==typeof n&&(n=n.split(_));for(var a,p,c,d,f,m,y=o(n),g=new l(e),x=[],A=[],k=[],E=!1,Q=!1;!g.eos();){if(a=g.pos,c=g.scanUntil(y[0]))for(var T=0,P=c.length;P>T;++T)d=c.charAt(T),r(d)?k.push(A.length):Q=!0,A.push(["text",d,a,a+1]),a+=1,"\n"===d&&s();if(!g.scan(y[0]))break;if(E=!0,p=g.scan(w)||"name",g.scan(v),"="===p?(c=g.scanUntil(b),g.scan(b),g.scanUntil(y[1])):"{"===p?(c=g.scanUntil(new RegExp("\\s*"+i("}"+n[1]))),g.scan(S),g.scanUntil(y[1]),p="&"):c=g.scanUntil(y[1]),!g.scan(y[1]))throw new Error("Unclosed tag at "+g.pos);if(f=[p,c,a,g.pos],A.push(f),"#"===p||"^"===p)x.push(f);else if("/"===p){if(m=x.pop(),!m)throw new Error('Unopened section "'+c+'" at '+a);if(m[1]!==c)throw new Error('Unclosed section "'+m[1]+'" at '+a)}else"name"===p||"{"===p||"&"===p?Q=!0:"="===p&&(y=o(n=c.split(_)))}if(m=x.pop())throw new Error('Unclosed section "'+m[1]+'" at '+g.pos);return h(u(A))}function u(t){for(var e,r,n=[],i=0,s=t.length;s>i;++i)e=t[i],e&&("text"===e[0]&&r&&"text"===r[0]?(r[1]+=e[1],r[3]=e[3]):(n.push(e),r=e));return n}function h(t){for(var e,r,n=[],i=n,s=[],o=0,a=t.length;a>o;++o)switch(e=t[o],e[0]){case"#":case"^":i.push(e),s.push(e),i=e[4]=[];break;case"/":r=s.pop(),r[5]=e[2],i=s.length>0?s[s.length-1][4]:n;break;default:i.push(e)}return n}function l(t){this.string=t,this.tail=t,this.pos=0}function p(t,e){this.view=null==t?{}:t,this.cache={".":this.view},this.parent=e}function c(){this.cache={}}var d=RegExp.prototype.test,f=/\S/,m=Object.prototype.toString,y=Array.isArray||function(t){return"[object Array]"===m.call(t)},g={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},v=/\s*/,_=/\s+/,b=/\s*=/,S=/\s*\}/,w=/#|\^|\/|>|\{|&|=|!/;l.prototype.eos=function(){return""===this.tail},l.prototype.scan=function(t){var e=this.tail.match(t);if(e&&0===e.index){var r=e[0];return this.tail=this.tail.substring(r.length),this.pos+=r.length,r}return""},l.prototype.scanUntil=function(t){var e,r=this.tail.search(t);switch(r){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,r),this.tail=this.tail.substring(r)}return this.pos+=e.length,e},p.prototype.push=function(t){return new p(t,this)},p.prototype.lookup=function(t){var e;if(t in this.cache)e=this.cache[t];else{for(var r=this;r;){if(t.indexOf(".")>0){e=r.view;for(var i=t.split("."),s=0;null!=e&&s<i.length;)e=e[i[s++]]}else e=r.view[t];if(null!=e)break;r=r.parent}this.cache[t]=e}return n(e)&&(e=e.call(this.view)),e},c.prototype.clearCache=function(){this.cache={}},c.prototype.parse=function(t,e){var r=this.cache,n=r[t];return null==n&&(n=r[t]=a(t,e)),n},c.prototype.render=function(t,e,r){var n=this.parse(t),i=e instanceof p?e:new p(e);return this.renderTokens(n,i,r,t)},c.prototype.renderTokens=function(e,r,i,s){function o(t){return l.render(t,r,i)}for(var a,u,h="",l=this,p=0,c=e.length;c>p;++p)switch(a=e[p],a[0]){case"#":if(u=r.lookup(a[1]),!u)continue;if(y(u))for(var d=0,f=u.length;f>d;++d)h+=this.renderTokens(a[4],r.push(u[d]),i,s);else if("object"==typeof u||"string"==typeof u)h+=this.renderTokens(a[4],r.push(u),i,s);else if(n(u)){if("string"!=typeof s)throw new Error("Cannot use higher-order sections without the original template");u=u.call(r.view,s.slice(a[3],a[5]),o),null!=u&&(h+=u)}else h+=this.renderTokens(a[4],r,i,s);break;case"^":u=r.lookup(a[1]),(!u||y(u)&&0===u.length)&&(h+=this.renderTokens(a[4],r,i,s));break;case">":if(!i)continue;u=n(i)?i(a[1]):i[a[1]],null!=u&&(h+=this.renderTokens(this.parse(u),r,i,u));break;case"&":u=r.lookup(a[1]),null!=u&&(h+=u);break;case"name":u=r.lookup(a[1]),null!=u&&(h+=t.escape(u));break;case"text":h+=a[1]}return h},t.name="mustache.js",t.version="0.8.1",t.tags=["{{","}}"];var x=new c;t.clearCache=function(){return x.clearCache()},t.parse=function(t,e){return x.parse(t,e)},t.render=function(t,e,r){return x.render(t,e,r)},t.to_html=function(e,r,i,s){var o=t.render(e,r,i);return n(s)?void s(o):o},t.escape=s,t.Scanner=l,t.Context=p,t.Writer=c});var dateFormat=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,r=/[^-+\dA-Z]/g,n=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t};return function(i,s,o){var a=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(i)||/\d/.test(i)||(s=i,i=void 0),i=i?new Date(i):new Date,isNaN(i))throw SyntaxError("invalid date");s=String(a.masks[s]||s||a.masks["default"]),"UTC:"==s.slice(0,4)&&(s=s.slice(4),o=!0);var u=o?"getUTC":"get",h=i[u+"Date"](),l=i[u+"Day"](),p=i[u+"Month"](),c=i[u+"FullYear"](),d=i[u+"Hours"](),f=i[u+"Minutes"](),m=i[u+"Seconds"](),y=i[u+"Milliseconds"](),g=o?0:i.getTimezoneOffset(),v={d:h,dd:n(h),ddd:a.i18n.dayNames[l],dddd:a.i18n.dayNames[l+7],m:p+1,mm:n(p+1),mmm:a.i18n.monthNames[p],mmmm:a.i18n.monthNames[p+12],yy:String(c).slice(2),yyyy:c,h:d%12||12,hh:n(d%12||12),H:d,HH:n(d),M:f,MM:n(f),s:m,ss:n(m),l:n(y,3),L:n(y>99?Math.round(y/10):y),t:12>d?"a":"p",tt:12>d?"am":"pm",T:12>d?"A":"P",TT:12>d?"AM":"PM",Z:o?"UTC":(String(i).match(e)||[""]).pop().replace(r,""),o:(g>0?"-":"+")+n(100*Math.floor(Math.abs(g)/60)+Math.abs(g)%60,4),S:["th","st","nd","rd"][h%10>3?0:(h%100-h%10!=10)*h%10]};return s.replace(t,function(t){return t in v?v[t]:t.slice(1,t.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(t,e){return dateFormat(this,t,e)},/*!
 * URI.js - Mutating URLs
 *
 * Version: 1.12.1
 *
 * Author: Rodney Rehm
 * Web: http://medialize.github.com/URI.js/
 *
 * Licensed under
 *   MIT License http://www.opensource.org/licenses/mit-license
 *   GPL v3 http://opensource.org/licenses/GPL-3.0
 *
 */
function(t,e){"object"==typeof exports?module.exports=e(require("./punycode"),require("./IPv6"),require("./SecondLevelDomains")):"function"==typeof define&&define.amd?define(["./punycode","./IPv6","./SecondLevelDomains"],e):t.URI=e(t.punycode,t.IPv6,t.SecondLevelDomains,t)}(this,function(t,e,r,n){"use strict";function i(t,e){return this instanceof i?(void 0===t&&(t="undefined"!=typeof location?location.href+"":""),this.href(t),void 0!==e?this.absoluteTo(e):this):new i(t,e)}function s(t){return t.replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}function o(t){return void 0===t?"Undefined":String(Object.prototype.toString.call(t)).slice(8,-1)}function a(t){return"Array"===o(t)}function u(t,e){var r,n,i={};if(a(e))for(r=0,n=e.length;n>r;r++)i[e[r]]=!0;else i[e]=!0;for(r=0,n=t.length;n>r;r++)void 0!==i[t[r]]&&(t.splice(r,1),n--,r--);return t}function h(t,e){var r,n;if(a(e)){for(r=0,n=e.length;n>r;r++)if(!h(t,e[r]))return!1;return!0}var i=o(e);for(r=0,n=t.length;n>r;r++)if("RegExp"===i){if("string"==typeof t[r]&&t[r].match(e))return!0}else if(t[r]===e)return!0;return!1}function l(t,e){if(!a(t)||!a(e))return!1;if(t.length!==e.length)return!1;t.sort(),e.sort();for(var r=0,n=t.length;n>r;r++)if(t[r]!==e[r])return!1;return!0}function p(t){return escape(t)}function c(t){return encodeURIComponent(t).replace(/[!'()*]/g,p).replace(/\*/g,"%2A")}var d=n&&n.URI;i.version="1.12.1";var f=i.prototype,m=Object.prototype.hasOwnProperty;i._parts=function(){return{protocol:null,username:null,password:null,hostname:null,urn:null,port:null,path:null,query:null,fragment:null,duplicateQueryParameters:i.duplicateQueryParameters,escapeQuerySpace:i.escapeQuerySpace}},i.duplicateQueryParameters=!1,i.escapeQuerySpace=!0,i.protocol_expression=/^[a-z][a-z0-9.+-]*$/i,i.idn_expression=/[^a-z0-9\.-]/i,i.punycode_expression=/(xn--)/i,i.ip4_expression=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,i.ip6_expression=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,i.find_uri_expression=/\b((?:[a-z][\w-]+:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\xab\xbb\u201c\u201d\u2018\u2019]))/gi,i.findUri={start:/\b(?:([a-z][a-z0-9.+-]*:\/\/)|www\.)/gi,end:/[\s\r\n]|$/,trim:/[`!()\[\]{};:'".,<>?\xab\xbb\u201c\u201d\u201e\u2018\u2019]+$/},i.defaultPorts={http:"80",https:"443",ftp:"21",gopher:"70",ws:"80",wss:"443"},i.invalid_hostname_characters=/[^a-zA-Z0-9\.-]/,i.domAttributes={a:"href",blockquote:"cite",link:"href",base:"href",script:"src",form:"action",img:"src",area:"href",iframe:"src",embed:"src",source:"src",track:"src",input:"src"},i.getDomAttribute=function(t){if(!t||!t.nodeName)return void 0;var e=t.nodeName.toLowerCase();return"input"===e&&"image"!==t.type?void 0:i.domAttributes[e]},i.encode=c,i.decode=decodeURIComponent,i.iso8859=function(){i.encode=escape,i.decode=unescape},i.unicode=function(){i.encode=c,i.decode=decodeURIComponent},i.characters={pathname:{encode:{expression:/%(24|26|2B|2C|3B|3D|3A|40)/gi,map:{"%24":"$","%26":"&","%2B":"+","%2C":",","%3B":";","%3D":"=","%3A":":","%40":"@"}},decode:{expression:/[\/\?#]/g,map:{"/":"%2F","?":"%3F","#":"%23"}}},reserved:{encode:{expression:/%(21|23|24|26|27|28|29|2A|2B|2C|2F|3A|3B|3D|3F|40|5B|5D)/gi,map:{"%3A":":","%2F":"/","%3F":"?","%23":"#","%5B":"[","%5D":"]","%40":"@","%21":"!","%24":"$","%26":"&","%27":"'","%28":"(","%29":")","%2A":"*","%2B":"+","%2C":",","%3B":";","%3D":"="}}}},i.encodeQuery=function(t,e){var r=i.encode(t+"");return void 0===e&&(e=i.escapeQuerySpace),e?r.replace(/%20/g,"+"):r},i.decodeQuery=function(t,e){t+="",void 0===e&&(e=i.escapeQuerySpace);try{return i.decode(e?t.replace(/\+/g,"%20"):t)}catch(r){return t}},i.recodePath=function(t){for(var e=(t+"").split("/"),r=0,n=e.length;n>r;r++)e[r]=i.encodePathSegment(i.decode(e[r]));return e.join("/")},i.decodePath=function(t){for(var e=(t+"").split("/"),r=0,n=e.length;n>r;r++)e[r]=i.decodePathSegment(e[r]);return e.join("/")};var y,g={encode:"encode",decode:"decode"},v=function(t,e){return function(r){return i[e](r+"").replace(i.characters[t][e].expression,function(r){return i.characters[t][e].map[r]})}};for(y in g)i[y+"PathSegment"]=v("pathname",g[y]);i.encodeReserved=v("reserved","encode"),i.parse=function(t,e){var r;return e||(e={}),r=t.indexOf("#"),r>-1&&(e.fragment=t.substring(r+1)||null,t=t.substring(0,r)),r=t.indexOf("?"),r>-1&&(e.query=t.substring(r+1)||null,t=t.substring(0,r)),"//"===t.substring(0,2)?(e.protocol=null,t=t.substring(2),t=i.parseAuthority(t,e)):(r=t.indexOf(":"),r>-1&&(e.protocol=t.substring(0,r)||null,e.protocol&&!e.protocol.match(i.protocol_expression)?e.protocol=void 0:"file"===e.protocol?t=t.substring(r+3):"//"===t.substring(r+1,r+3)?(t=t.substring(r+3),t=i.parseAuthority(t,e)):(t=t.substring(r+1),e.urn=!0))),e.path=t,e},i.parseHost=function(t,e){var r,n,i=t.indexOf("/");return-1===i&&(i=t.length),"["===t.charAt(0)?(r=t.indexOf("]"),e.hostname=t.substring(1,r)||null,e.port=t.substring(r+2,i)||null):t.indexOf(":")!==t.lastIndexOf(":")?(e.hostname=t.substring(0,i)||null,e.port=null):(n=t.substring(0,i).split(":"),e.hostname=n[0]||null,e.port=n[1]||null),e.hostname&&"/"!==t.substring(i).charAt(0)&&(i++,t="/"+t),t.substring(i)||"/"},i.parseAuthority=function(t,e){return t=i.parseUserinfo(t,e),i.parseHost(t,e)},i.parseUserinfo=function(t,e){var r,n=t.indexOf("/"),s=n>-1?t.lastIndexOf("@",n):t.indexOf("@");return s>-1&&(-1===n||n>s)?(r=t.substring(0,s).split(":"),e.username=r[0]?i.decode(r[0]):null,r.shift(),e.password=r[0]?i.decode(r.join(":")):null,t=t.substring(s+1)):(e.username=null,e.password=null),t},i.parseQuery=function(t,e){if(!t)return{};if(t=t.replace(/&+/g,"&").replace(/^\?*&*|&+$/g,""),!t)return{};for(var r,n,s,o={},a=t.split("&"),u=a.length,h=0;u>h;h++)r=a[h].split("="),n=i.decodeQuery(r.shift(),e),s=r.length?i.decodeQuery(r.join("="),e):null,o[n]?("string"==typeof o[n]&&(o[n]=[o[n]]),o[n].push(s)):o[n]=s;return o},i.build=function(t){var e="";return t.protocol&&(e+=t.protocol+":"),t.urn||!e&&!t.hostname||(e+="//"),e+=i.buildAuthority(t)||"","string"==typeof t.path&&("/"!==t.path.charAt(0)&&"string"==typeof t.hostname&&(e+="/"),e+=t.path),"string"==typeof t.query&&t.query&&(e+="?"+t.query),"string"==typeof t.fragment&&t.fragment&&(e+="#"+t.fragment),e},i.buildHost=function(t){var e="";return t.hostname?(i.ip6_expression.test(t.hostname)?e+=t.port?"["+t.hostname+"]:"+t.port:t.hostname:(e+=t.hostname,t.port&&(e+=":"+t.port)),e):""},i.buildAuthority=function(t){return i.buildUserinfo(t)+i.buildHost(t)},i.buildUserinfo=function(t){var e="";return t.username&&(e+=i.encode(t.username),t.password&&(e+=":"+i.encode(t.password)),e+="@"),e},i.buildQuery=function(t,e,r){var n,s,o,u,h="";for(s in t)if(m.call(t,s)&&s)if(a(t[s]))for(n={},o=0,u=t[s].length;u>o;o++)void 0!==t[s][o]&&void 0===n[t[s][o]+""]&&(h+="&"+i.buildQueryParameter(s,t[s][o],r),e!==!0&&(n[t[s][o]+""]=!0));else void 0!==t[s]&&(h+="&"+i.buildQueryParameter(s,t[s],r));return h.substring(1)},i.buildQueryParameter=function(t,e,r){return i.encodeQuery(t,r)+(null!==e?"="+i.encodeQuery(e,r):"")},i.addQuery=function(t,e,r){if("object"==typeof e)for(var n in e)m.call(e,n)&&i.addQuery(t,n,e[n]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");if(void 0===t[e])return void(t[e]=r);"string"==typeof t[e]&&(t[e]=[t[e]]),a(r)||(r=[r]),t[e]=t[e].concat(r)}},i.removeQuery=function(t,e,r){var n,s,o;if(a(e))for(n=0,s=e.length;s>n;n++)t[e[n]]=void 0;else if("object"==typeof e)for(o in e)m.call(e,o)&&i.removeQuery(t,o,e[o]);else{if("string"!=typeof e)throw new TypeError("URI.addQuery() accepts an object, string as the first parameter");void 0!==r?t[e]===r?t[e]=void 0:a(t[e])&&(t[e]=u(t[e],r)):t[e]=void 0}},i.hasQuery=function(t,e,r,n){if("object"==typeof e){for(var s in e)if(m.call(e,s)&&!i.hasQuery(t,s,e[s]))return!1;return!0}if("string"!=typeof e)throw new TypeError("URI.hasQuery() accepts an object, string as the name parameter");switch(o(r)){case"Undefined":return e in t;case"Boolean":var u=Boolean(a(t[e])?t[e].length:t[e]);return r===u;case"Function":return!!r(t[e],e,t);case"Array":if(!a(t[e]))return!1;var p=n?h:l;return p(t[e],r);case"RegExp":return a(t[e])?n?h(t[e],r):!1:Boolean(t[e]&&t[e].match(r));case"Number":r=String(r);case"String":return a(t[e])?n?h(t[e],r):!1:t[e]===r;default:throw new TypeError("URI.hasQuery() accepts undefined, boolean, string, number, RegExp, Function as the value parameter")}},i.commonPath=function(t,e){var r,n=Math.min(t.length,e.length);for(r=0;n>r;r++)if(t.charAt(r)!==e.charAt(r)){r--;break}return 1>r?t.charAt(0)===e.charAt(0)&&"/"===t.charAt(0)?"/":"":(("/"!==t.charAt(r)||"/"!==e.charAt(r))&&(r=t.substring(0,r).lastIndexOf("/")),t.substring(0,r+1))},i.withinString=function(t,e,r){r||(r={});var n=r.start||i.findUri.start,s=r.end||i.findUri.end,o=r.trim||i.findUri.trim,a=/[a-z0-9-]=["']?$/i;for(n.lastIndex=0;;){var u=n.exec(t);if(!u)break;var h=u.index;if(r.ignoreHtml){var l=t.slice(Math.max(h-3,0),h);if(l&&a.test(l))continue}var p=h+t.slice(h).search(s),c=t.slice(h,p).replace(o,"");if(!r.ignore||!r.ignore.test(c)){p=h+c.length;var d=e(c,h,p,t);t=t.slice(0,h)+d+t.slice(p),n.lastIndex=h+d.length}}return n.lastIndex=0,t},i.ensureValidHostname=function(e){if(e.match(i.invalid_hostname_characters)){if(!t)throw new TypeError("Hostname '"+e+"' contains characters other than [A-Z0-9.-] and Punycode.js is not available");if(t.toASCII(e).match(i.invalid_hostname_characters))throw new TypeError("Hostname '"+e+"' contains characters other than [A-Z0-9.-]")}},i.noConflict=function(t){if(t){var r={URI:this.noConflict()};return URITemplate&&"function"==typeof URITemplate.noConflict&&(r.URITemplate=URITemplate.noConflict()),e&&"function"==typeof e.noConflict&&(r.IPv6=e.noConflict()),SecondLevelDomains&&"function"==typeof SecondLevelDomains.noConflict&&(r.SecondLevelDomains=SecondLevelDomains.noConflict()),r}return n.URI===this&&(n.URI=d),this},f.build=function(t){return t===!0?this._deferred_build=!0:(void 0===t||this._deferred_build)&&(this._string=i.build(this._parts),this._deferred_build=!1),this},f.clone=function(){return new i(this)},f.valueOf=f.toString=function(){return this.build(!1)._string},g={protocol:"protocol",username:"username",password:"password",hostname:"hostname",port:"port"},v=function(t){return function(e,r){return void 0===e?this._parts[t]||"":(this._parts[t]=e||null,this.build(!r),this)}};for(y in g)f[y]=v(g[y]);g={query:"?",fragment:"#"},v=function(t,e){return function(r,n){return void 0===r?this._parts[t]||"":(null!==r&&(r+="",r.charAt(0)===e&&(r=r.substring(1))),this._parts[t]=r,this.build(!n),this)}};for(y in g)f[y]=v(y,g[y]);g={search:["?","query"],hash:["#","fragment"]},v=function(t,e){return function(r,n){var i=this[t](r,n);return"string"==typeof i&&i.length?e+i:i}};for(y in g)f[y]=v(g[y][1],g[y][0]);f.pathname=function(t,e){if(void 0===t||t===!0){var r=this._parts.path||(this._parts.hostname?"/":"");return t?i.decodePath(r):r}return this._parts.path=t?i.recodePath(t):"/",this.build(!e),this},f.path=f.pathname,f.href=function(t,e){var r;if(void 0===t)return this.toString();this._string="",this._parts=i._parts();var n=t instanceof i,s="object"==typeof t&&(t.hostname||t.path||t.pathname);if(t.nodeName){var o=i.getDomAttribute(t);t=t[o]||"",s=!1}if(!n&&s&&void 0!==t.pathname&&(t=t.toString()),"string"==typeof t)this._parts=i.parse(t,this._parts);else{if(!n&&!s)throw new TypeError("invalid input");var a=n?t._parts:t;for(r in a)m.call(this._parts,r)&&(this._parts[r]=a[r])}return this.build(!e),this},f.is=function(t){var e=!1,n=!1,s=!1,o=!1,a=!1,u=!1,h=!1,l=!this._parts.urn;switch(this._parts.hostname&&(l=!1,n=i.ip4_expression.test(this._parts.hostname),s=i.ip6_expression.test(this._parts.hostname),e=n||s,o=!e,a=o&&r&&r.has(this._parts.hostname),u=o&&i.idn_expression.test(this._parts.hostname),h=o&&i.punycode_expression.test(this._parts.hostname)),t.toLowerCase()){case"relative":return l;case"absolute":return!l;case"domain":case"name":return o;case"sld":return a;case"ip":return e;case"ip4":case"ipv4":case"inet4":return n;case"ip6":case"ipv6":case"inet6":return s;case"idn":return u;case"url":return!this._parts.urn;case"urn":return!!this._parts.urn;case"punycode":return h}return null};var _=f.protocol,b=f.port,S=f.hostname;f.protocol=function(t,e){if(void 0!==t&&t&&(t=t.replace(/:(\/\/)?$/,""),!t.match(i.protocol_expression)))throw new TypeError("Protocol '"+t+"' contains characters other than [A-Z0-9.+-] or doesn't start with [A-Z]");return _.call(this,t,e)},f.scheme=f.protocol,f.port=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t&&(0===t&&(t=null),t&&(t+="",":"===t.charAt(0)&&(t=t.substring(1)),t.match(/[^0-9]/))))throw new TypeError("Port '"+t+"' contains characters other than [0-9]");return b.call(this,t,e)},f.hostname=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0!==t){var r={};i.parseHost(t,r),t=r.hostname}return S.call(this,t,e)},f.host=function(t,e){return this._parts.urn?void 0===t?"":this:void 0===t?this._parts.hostname?i.buildHost(this._parts):"":(i.parseHost(t,this._parts),this.build(!e),this)},f.authority=function(t,e){return this._parts.urn?void 0===t?"":this:void 0===t?this._parts.hostname?i.buildAuthority(this._parts):"":(i.parseAuthority(t,this._parts),this.build(!e),this)},f.userinfo=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.username)return"";var r=i.buildUserinfo(this._parts);return r.substring(0,r.length-1)}return"@"!==t[t.length-1]&&(t+="@"),i.parseUserinfo(t,this._parts),this.build(!e),this},f.resource=function(t,e){var r;return void 0===t?this.path()+this.search()+this.hash():(r=i.parse(t),this._parts.path=r.path,this._parts.query=r.query,this._parts.fragment=r.fragment,this.build(!e),this)},f.subdomain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.length-this.domain().length-1;return this._parts.hostname.substring(0,r)||""}var n=this._parts.hostname.length-this.domain().length,o=this._parts.hostname.substring(0,n),a=new RegExp("^"+s(o));return t&&"."!==t.charAt(t.length-1)&&(t+="."),t&&i.ensureValidHostname(t),this._parts.hostname=this._parts.hostname.replace(a,t),this.build(!e),this},f.domain=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var r=this._parts.hostname.match(/\./g);if(r&&r.length<2)return this._parts.hostname;var n=this._parts.hostname.length-this.tld(e).length-1;return n=this._parts.hostname.lastIndexOf(".",n-1)+1,this._parts.hostname.substring(n)||""}if(!t)throw new TypeError("cannot set domain empty");if(i.ensureValidHostname(t),!this._parts.hostname||this.is("IP"))this._parts.hostname=t;else{var o=new RegExp(s(this.domain())+"$");this._parts.hostname=this._parts.hostname.replace(o,t)}return this.build(!e),this},f.tld=function(t,e){if(this._parts.urn)return void 0===t?"":this;if("boolean"==typeof t&&(e=t,t=void 0),void 0===t){if(!this._parts.hostname||this.is("IP"))return"";var n=this._parts.hostname.lastIndexOf("."),i=this._parts.hostname.substring(n+1);return e!==!0&&r&&r.list[i.toLowerCase()]?r.get(this._parts.hostname)||i:i}var o;if(!t)throw new TypeError("cannot set TLD empty");if(t.match(/[^a-zA-Z0-9-]/)){if(!r||!r.is(t))throw new TypeError("TLD '"+t+"' contains characters other than [A-Z0-9]");o=new RegExp(s(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,t)}else{if(!this._parts.hostname||this.is("IP"))throw new ReferenceError("cannot set TLD on non-domain host");o=new RegExp(s(this.tld())+"$"),this._parts.hostname=this._parts.hostname.replace(o,t)}return this.build(!e),this},f.directory=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||t===!0){if(!this._parts.path&&!this._parts.hostname)return"";if("/"===this._parts.path)return"/";var r=this._parts.path.length-this.filename().length-1,n=this._parts.path.substring(0,r)||(this._parts.hostname?"/":"");return t?i.decodePath(n):n}var o=this._parts.path.length-this.filename().length,a=this._parts.path.substring(0,o),u=new RegExp("^"+s(a));return this.is("relative")||(t||(t="/"),"/"!==t.charAt(0)&&(t="/"+t)),t&&"/"!==t.charAt(t.length-1)&&(t+="/"),t=i.recodePath(t),this._parts.path=this._parts.path.replace(u,t),this.build(!e),this},f.filename=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||t===!0){if(!this._parts.path||"/"===this._parts.path)return"";var r=this._parts.path.lastIndexOf("/"),n=this._parts.path.substring(r+1);return t?i.decodePathSegment(n):n}var o=!1;"/"===t.charAt(0)&&(t=t.substring(1)),t.match(/\.?\//)&&(o=!0);var a=new RegExp(s(this.filename())+"$");return t=i.recodePath(t),this._parts.path=this._parts.path.replace(a,t),o?this.normalizePath(e):this.build(!e),this},f.suffix=function(t,e){if(this._parts.urn)return void 0===t?"":this;if(void 0===t||t===!0){if(!this._parts.path||"/"===this._parts.path)return"";var r,n,o=this.filename(),a=o.lastIndexOf(".");return-1===a?"":(r=o.substring(a+1),n=/^[a-z0-9%]+$/i.test(r)?r:"",t?i.decodePathSegment(n):n)}"."===t.charAt(0)&&(t=t.substring(1));var u,h=this.suffix();if(h)u=new RegExp(t?s(h)+"$":s("."+h)+"$");else{if(!t)return this;this._parts.path+="."+i.recodePath(t)}return u&&(t=i.recodePath(t),this._parts.path=this._parts.path.replace(u,t)),this.build(!e),this},f.segment=function(t,e,r){var n=this._parts.urn?":":"/",i=this.path(),s="/"===i.substring(0,1),o=i.split(n);if(void 0!==t&&"number"!=typeof t&&(r=e,e=t,t=void 0),void 0!==t&&"number"!=typeof t)throw new Error("Bad segment '"+t+"', must be 0-based integer");if(s&&o.shift(),0>t&&(t=Math.max(o.length+t,0)),void 0===e)return void 0===t?o:o[t];if(null===t||void 0===o[t])if(a(e)){o=[];for(var u=0,h=e.length;h>u;u++)(e[u].length||o.length&&o[o.length-1].length)&&(o.length&&!o[o.length-1].length&&o.pop(),o.push(e[u]))}else(e||"string"==typeof e)&&(""===o[o.length-1]?o[o.length-1]=e:o.push(e));else e||"string"==typeof e&&e.length?o[t]=e:o.splice(t,1);return s&&o.unshift(""),this.path(o.join(n),r)},f.segmentCoded=function(t,e,r){var n,s,o;if("number"!=typeof t&&(r=e,e=t,t=void 0),void 0===e){if(n=this.segment(t,e,r),a(n))for(s=0,o=n.length;o>s;s++)n[s]=i.decode(n[s]);else n=void 0!==n?i.decode(n):void 0;return n}if(a(e))for(s=0,o=e.length;o>s;s++)e[s]=i.decode(e[s]);else e="string"==typeof e?i.encode(e):e;return this.segment(t,e,r)};var w=f.query;return f.query=function(t,e){if(t===!0)return i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("function"==typeof t){var r=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace),n=t.call(this,r);return this._parts.query=i.buildQuery(n||r,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!e),this}return void 0!==t&&"string"!=typeof t?(this._parts.query=i.buildQuery(t,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),this.build(!e),this):w.call(this,t,e)},f.setQuery=function(t,e,r){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);if("object"==typeof t)for(var s in t)m.call(t,s)&&(n[s]=t[s]);else{if("string"!=typeof t)throw new TypeError("URI.addQuery() accepts an object, string as the name parameter");n[t]=void 0!==e?e:null}return this._parts.query=i.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},f.addQuery=function(t,e,r){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.addQuery(n,t,void 0===e?null:e),this._parts.query=i.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},f.removeQuery=function(t,e,r){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.removeQuery(n,t,e),this._parts.query=i.buildQuery(n,this._parts.duplicateQueryParameters,this._parts.escapeQuerySpace),"string"!=typeof t&&(r=e),this.build(!r),this},f.hasQuery=function(t,e,r){var n=i.parseQuery(this._parts.query,this._parts.escapeQuerySpace);return i.hasQuery(n,t,e,r)},f.setSearch=f.setQuery,f.addSearch=f.addQuery,f.removeSearch=f.removeQuery,f.hasSearch=f.hasQuery,f.normalize=function(){return this._parts.urn?this.normalizeProtocol(!1).normalizeQuery(!1).normalizeFragment(!1).build():this.normalizeProtocol(!1).normalizeHostname(!1).normalizePort(!1).normalizePath(!1).normalizeQuery(!1).normalizeFragment(!1).build()},f.normalizeProtocol=function(t){return"string"==typeof this._parts.protocol&&(this._parts.protocol=this._parts.protocol.toLowerCase(),this.build(!t)),this},f.normalizeHostname=function(r){return this._parts.hostname&&(this.is("IDN")&&t?this._parts.hostname=t.toASCII(this._parts.hostname):this.is("IPv6")&&e&&(this._parts.hostname=e.best(this._parts.hostname)),this._parts.hostname=this._parts.hostname.toLowerCase(),this.build(!r)),this},f.normalizePort=function(t){return"string"==typeof this._parts.protocol&&this._parts.port===i.defaultPorts[this._parts.protocol]&&(this._parts.port=null,this.build(!t)),this},f.normalizePath=function(t){if(this._parts.urn)return this;if(!this._parts.path||"/"===this._parts.path)return this;var e,r,n,s=this._parts.path,o="";for("/"!==s.charAt(0)&&(e=!0,s="/"+s),s=s.replace(/(\/(\.\/)+)|(\/\.$)/g,"/").replace(/\/{2,}/g,"/"),e&&(o=s.substring(1).match(/^(\.\.\/)+/)||"",o&&(o=o[0]));;){if(r=s.indexOf("/.."),-1===r)break;0!==r?(n=s.substring(0,r).lastIndexOf("/"),-1===n&&(n=r),s=s.substring(0,n)+s.substring(r+3)):s=s.substring(3)}return e&&this.is("relative")&&(s=o+s.substring(1)),s=i.recodePath(s),this._parts.path=s,this.build(!t),this},f.normalizePathname=f.normalizePath,f.normalizeQuery=function(t){return"string"==typeof this._parts.query&&(this._parts.query.length?this.query(i.parseQuery(this._parts.query,this._parts.escapeQuerySpace)):this._parts.query=null,this.build(!t)),this},f.normalizeFragment=function(t){return this._parts.fragment||(this._parts.fragment=null,this.build(!t)),this},f.normalizeSearch=f.normalizeQuery,f.normalizeHash=f.normalizeFragment,f.iso8859=function(){var t=i.encode,e=i.decode;return i.encode=escape,i.decode=decodeURIComponent,this.normalize(),i.encode=t,i.decode=e,this},f.unicode=function(){var t=i.encode,e=i.decode;return i.encode=c,i.decode=unescape,this.normalize(),i.encode=t,i.decode=e,this},f.readable=function(){var e=this.clone();e.username("").password("").normalize();var r="";if(e._parts.protocol&&(r+=e._parts.protocol+"://"),e._parts.hostname&&(e.is("punycode")&&t?(r+=t.toUnicode(e._parts.hostname),e._parts.port&&(r+=":"+e._parts.port)):r+=e.host()),e._parts.hostname&&e._parts.path&&"/"!==e._parts.path.charAt(0)&&(r+="/"),r+=e.path(!0),e._parts.query){for(var n="",s=0,o=e._parts.query.split("&"),a=o.length;a>s;s++){var u=(o[s]||"").split("=");n+="&"+i.decodeQuery(u[0],this._parts.escapeQuerySpace).replace(/&/g,"%26"),void 0!==u[1]&&(n+="="+i.decodeQuery(u[1],this._parts.escapeQuerySpace).replace(/&/g,"%26"))}r+="?"+n.substring(1)}return r+=i.decodeQuery(e.hash(),!0)},f.absoluteTo=function(t){var e,r,n,s=this.clone(),o=["protocol","username","password","hostname","port"];if(this._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t instanceof i||(t=new i(t)),s._parts.protocol||(s._parts.protocol=t._parts.protocol),this._parts.hostname)return s;for(r=0;n=o[r];r++)s._parts[n]=t._parts[n];return s._parts.path?".."===s._parts.path.substring(-2)&&(s._parts.path+="/"):(s._parts.path=t._parts.path,s._parts.query||(s._parts.query=t._parts.query)),"/"!==s.path().charAt(0)&&(e=t.directory(),s._parts.path=(e?e+"/":"")+s._parts.path,s.normalizePath()),s.build(),s},f.relativeTo=function(t){var e,r,n,s,o,a=this.clone().normalize();if(a._parts.urn)throw new Error("URNs do not have any generally defined hierarchical components");if(t=new i(t).normalize(),e=a._parts,r=t._parts,s=a.path(),o=t.path(),"/"!==s.charAt(0))throw new Error("URI is already relative");if("/"!==o.charAt(0))throw new Error("Cannot calculate a URI relative to another relative URI");if(e.protocol===r.protocol&&(e.protocol=null),e.username!==r.username||e.password!==r.password)return a.build();if(null!==e.protocol||null!==e.username||null!==e.password)return a.build();if(e.hostname!==r.hostname||e.port!==r.port)return a.build();if(e.hostname=null,e.port=null,s===o)return e.path="",a.build();if(n=i.commonPath(a.path(),t.path()),!n)return a.build();var u=r.path.substring(n.length).replace(/[^\/]*$/,"").replace(/.*?\//g,"../");return e.path=u+e.path.substring(n.length),a.build()},f.equals=function(t){var e,r,n,s=this.clone(),o=new i(t),u={},h={},p={};if(s.normalize(),o.normalize(),s.toString()===o.toString())return!0;if(e=s.query(),r=o.query(),s.query(""),o.query(""),s.toString()!==o.toString())return!1;if(e.length!==r.length)return!1;u=i.parseQuery(e,this._parts.escapeQuerySpace),h=i.parseQuery(r,this._parts.escapeQuerySpace);for(n in u)if(m.call(u,n)){if(a(u[n])){if(!l(u[n],h[n]))return!1}else if(u[n]!==h[n])return!1;p[n]=!0}for(n in h)if(m.call(h,n)&&!p[n])return!1;return!0},f.duplicateQueryParameters=function(t){return this._parts.duplicateQueryParameters=!!t,this},f.escapeQuerySpace=function(t){return this._parts.escapeQuerySpace=!!t,this},i});/**
 * lunr - http://lunrjs.com - A bit like Solr, but much smaller and not as bright - 0.4.5
 * Copyright (C) 2014 Oliver Nightingale
 * MIT Licensed
 * @license
 */
var lunr=function(t){var e=new lunr.Index;return e.pipeline.add(lunr.stopWordFilter,lunr.stemmer),t&&t.call(e,e),e};lunr.version="0.4.5","undefined"!=typeof module&&(module.exports=lunr),lunr.utils={},lunr.utils.warn=function(t){return function(e){t.console&&console.warn&&console.warn(e)}}(this),lunr.utils.zeroFillArray=function(){var t=[0];return function(e){for(;e>t.length;)t=t.concat(t);return t.slice(0,e)}}(),lunr.EventEmitter=function(){this.events={}},lunr.EventEmitter.prototype.addListener=function(){var t=Array.prototype.slice.call(arguments),e=t.pop(),r=t;if("function"!=typeof e)throw new TypeError("last argument must be a function");r.forEach(function(t){this.hasHandler(t)||(this.events[t]=[]),this.events[t].push(e)},this)},lunr.EventEmitter.prototype.removeListener=function(t,e){if(this.hasHandler(t)){var r=this.events[t].indexOf(e);this.events[t].splice(r,1),this.events[t].length||delete this.events[t]}},lunr.EventEmitter.prototype.emit=function(t){if(this.hasHandler(t)){var e=Array.prototype.slice.call(arguments,1);this.events[t].forEach(function(t){t.apply(void 0,e)})}},lunr.EventEmitter.prototype.hasHandler=function(t){return t in this.events},lunr.tokenizer=function(t){if(!arguments.length||null==t||void 0==t)return[];if(Array.isArray(t))return t.map(function(t){return t.toLowerCase()});for(var e=(""+t).replace(/^\s+/,""),r=e.length-1;r>=0;r--)if(/\S/.test(e.charAt(r))){e=e.substring(0,r+1);break}return e.split(/\s+/).map(function(t){return t.replace(/^\W+/,"").replace(/\W+$/,"").toLowerCase()})},lunr.Pipeline=function(){this._stack=[]},lunr.Pipeline.registeredFunctions={},lunr.Pipeline.registerFunction=function(t,e){e in this.registeredFunctions&&lunr.utils.warn("Overwriting existing registered function: "+e),t.label=e,lunr.Pipeline.registeredFunctions[t.label]=t},lunr.Pipeline.warnIfFunctionNotRegistered=function(t){var e=t.label&&t.label in this.registeredFunctions;e||lunr.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",t)},lunr.Pipeline.load=function(t){var e=new lunr.Pipeline;return t.forEach(function(t){var r=lunr.Pipeline.registeredFunctions[t];if(!r)throw Error("Cannot load un-registered function: "+t);e.add(r)}),e},lunr.Pipeline.prototype.add=function(){var t=Array.prototype.slice.call(arguments);t.forEach(function(t){lunr.Pipeline.warnIfFunctionNotRegistered(t),this._stack.push(t)},this)},lunr.Pipeline.prototype.after=function(t,e){lunr.Pipeline.warnIfFunctionNotRegistered(e);var r=this._stack.indexOf(t)+1;this._stack.splice(r,0,e)},lunr.Pipeline.prototype.before=function(t,e){lunr.Pipeline.warnIfFunctionNotRegistered(e);var r=this._stack.indexOf(t);this._stack.splice(r,0,e)},lunr.Pipeline.prototype.remove=function(t){var e=this._stack.indexOf(t);this._stack.splice(e,1)},lunr.Pipeline.prototype.run=function(t){for(var e=[],r=t.length,n=this._stack.length,i=0;r>i;i++){for(var s=t[i],o=0;n>o&&(s=this._stack[o](s,i,t),void 0!==s);o++);void 0!==s&&e.push(s)}return e},lunr.Pipeline.prototype.toJSON=function(){return this._stack.map(function(t){return lunr.Pipeline.warnIfFunctionNotRegistered(t),t.label})},lunr.Vector=function(t){this.elements=t},lunr.Vector.prototype.magnitude=function(){if(this._magnitude)return this._magnitude;for(var t,e=0,r=this.elements,n=r.length,i=0;n>i;i++)t=r[i],e+=t*t;return this._magnitude=Math.sqrt(e)},lunr.Vector.prototype.dot=function(t){for(var e=this.elements,r=t.elements,n=e.length,i=0,s=0;n>s;s++)i+=e[s]*r[s];return i},lunr.Vector.prototype.similarity=function(t){return this.dot(t)/(this.magnitude()*t.magnitude())},lunr.Vector.prototype.toArray=function(){return this.elements},lunr.SortedSet=function(){this.length=0,this.elements=[]},lunr.SortedSet.load=function(t){var e=new this;return e.elements=t,e.length=t.length,e},lunr.SortedSet.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(t){~this.indexOf(t)||this.elements.splice(this.locationFor(t),0,t)},this),this.length=this.elements.length},lunr.SortedSet.prototype.toArray=function(){return this.elements.slice()},lunr.SortedSet.prototype.map=function(t,e){return this.elements.map(t,e)},lunr.SortedSet.prototype.forEach=function(t,e){return this.elements.forEach(t,e)},lunr.SortedSet.prototype.indexOf=function(t,e,r){var e=e||0,r=r||this.elements.length,n=r-e,i=e+Math.floor(n/2),s=this.elements[i];return 1>=n?s===t?i:-1:t>s?this.indexOf(t,i,r):s>t?this.indexOf(t,e,i):s===t?i:void 0},lunr.SortedSet.prototype.locationFor=function(t,e,r){var e=e||0,r=r||this.elements.length,n=r-e,i=e+Math.floor(n/2),s=this.elements[i];if(1>=n){if(s>t)return i;if(t>s)return i+1}return t>s?this.locationFor(t,i,r):s>t?this.locationFor(t,e,i):void 0},lunr.SortedSet.prototype.intersect=function(t){for(var e=new lunr.SortedSet,r=0,n=0,i=this.length,s=t.length,o=this.elements,a=t.elements;!(r>i-1||n>s-1);)o[r]!==a[n]?o[r]<a[n]?r++:o[r]>a[n]&&n++:(e.add(o[r]),r++,n++);return e},lunr.SortedSet.prototype.clone=function(){var t=new lunr.SortedSet;return t.elements=this.toArray(),t.length=t.elements.length,t},lunr.SortedSet.prototype.union=function(t){var e,r,n;return this.length>=t.length?(e=this,r=t):(e=t,r=this),n=e.clone(),n.add.apply(n,r.toArray()),n},lunr.SortedSet.prototype.toJSON=function(){return this.toArray()},lunr.Index=function(){this._fields=[],this._ref="id",this.pipeline=new lunr.Pipeline,this.documentStore=new lunr.Store,this.tokenStore=new lunr.TokenStore,this.corpusTokens=new lunr.SortedSet,this.eventEmitter=new lunr.EventEmitter,this._idfCache={},this.on("add","remove","update",function(){this._idfCache={}}.bind(this))},lunr.Index.prototype.on=function(){var t=Array.prototype.slice.call(arguments);return this.eventEmitter.addListener.apply(this.eventEmitter,t)},lunr.Index.prototype.off=function(t,e){return this.eventEmitter.removeListener(t,e)},lunr.Index.load=function(t){t.version!==lunr.version&&lunr.utils.warn("version mismatch: current "+lunr.version+" importing "+t.version);var e=new this;return e._fields=t.fields,e._ref=t.ref,e.documentStore=lunr.Store.load(t.documentStore),e.tokenStore=lunr.TokenStore.load(t.tokenStore),e.corpusTokens=lunr.SortedSet.load(t.corpusTokens),e.pipeline=lunr.Pipeline.load(t.pipeline),e},lunr.Index.prototype.field=function(t,e){var e=e||{},r={name:t,boost:e.boost||1};return this._fields.push(r),this},lunr.Index.prototype.ref=function(t){return this._ref=t,this},lunr.Index.prototype.add=function(t,e){var r={},n=new lunr.SortedSet,i=t[this._ref],e=void 0===e?!0:e;this._fields.forEach(function(e){var i=this.pipeline.run(lunr.tokenizer(t[e.name]));r[e.name]=i,lunr.SortedSet.prototype.add.apply(n,i)},this),this.documentStore.set(i,n),lunr.SortedSet.prototype.add.apply(this.corpusTokens,n.toArray());for(var s=0;n.length>s;s++){var o=n.elements[s],a=this._fields.reduce(function(t,e){var n=r[e.name].length;if(!n)return t;var i=r[e.name].filter(function(t){return t===o}).length;return t+i/n*e.boost},0);this.tokenStore.add(o,{ref:i,tf:a})}e&&this.eventEmitter.emit("add",t,this)},lunr.Index.prototype.remove=function(t,e){var r=t[this._ref],e=void 0===e?!0:e;if(this.documentStore.has(r)){var n=this.documentStore.get(r);this.documentStore.remove(r),n.forEach(function(t){this.tokenStore.remove(t,r)},this),e&&this.eventEmitter.emit("remove",t,this)}},lunr.Index.prototype.update=function(t,e){var e=void 0===e?!0:e;this.remove(t,!1),this.add(t,!1),e&&this.eventEmitter.emit("update",t,this)},lunr.Index.prototype.idf=function(t){var e="@"+t;if(Object.prototype.hasOwnProperty.call(this._idfCache,e))return this._idfCache[e];var r=this.tokenStore.count(t),n=1;return r>0&&(n=1+Math.log(this.tokenStore.length/r)),this._idfCache[e]=n},lunr.Index.prototype.search=function(t){var e=this.pipeline.run(lunr.tokenizer(t)),r=lunr.utils.zeroFillArray(this.corpusTokens.length),n=[],i=this._fields.reduce(function(t,e){return t+e.boost},0),s=e.some(function(t){return this.tokenStore.has(t)},this);if(!s)return[];e.forEach(function(t,e,s){var o=1/s.length*this._fields.length*i,a=this,u=this.tokenStore.expand(t).reduce(function(e,n){var i=a.corpusTokens.indexOf(n),s=a.idf(n),u=1,h=new lunr.SortedSet;if(n!==t){var l=Math.max(3,n.length-t.length);u=1/Math.log(l)}return i>-1&&(r[i]=o*s*u),Object.keys(a.tokenStore.get(n)).forEach(function(t){h.add(t)}),e.union(h)},new lunr.SortedSet);n.push(u)},this);var o=n.reduce(function(t,e){return t.intersect(e)}),a=new lunr.Vector(r);return o.map(function(t){return{ref:t,score:a.similarity(this.documentVector(t))}},this).sort(function(t,e){return e.score-t.score})},lunr.Index.prototype.documentVector=function(t){for(var e=this.documentStore.get(t),r=e.length,n=lunr.utils.zeroFillArray(this.corpusTokens.length),i=0;r>i;i++){var s=e.elements[i],o=this.tokenStore.get(s)[t].tf,a=this.idf(s);n[this.corpusTokens.indexOf(s)]=o*a}return new lunr.Vector(n)},lunr.Index.prototype.toJSON=function(){return{version:lunr.version,fields:this._fields,ref:this._ref,documentStore:this.documentStore.toJSON(),tokenStore:this.tokenStore.toJSON(),corpusTokens:this.corpusTokens.toJSON(),pipeline:this.pipeline.toJSON()}},lunr.Store=function(){this.store={},this.length=0},lunr.Store.load=function(t){var e=new this;return e.length=t.length,e.store=Object.keys(t.store).reduce(function(e,r){return e[r]=lunr.SortedSet.load(t.store[r]),e},{}),e},lunr.Store.prototype.set=function(t,e){this.store[t]=e,this.length=Object.keys(this.store).length},lunr.Store.prototype.get=function(t){return this.store[t]},lunr.Store.prototype.has=function(t){return t in this.store},lunr.Store.prototype.remove=function(t){this.has(t)&&(delete this.store[t],this.length--)},lunr.Store.prototype.toJSON=function(){return{store:this.store,length:this.length}},lunr.stemmer=function(){var t={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},e={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},r="[^aeiou]",n="[aeiouy]",i=r+"[^aeiouy]*",s=n+"[aeiou]*",o="^("+i+")?"+s+i,a="^("+i+")?"+s+i+"("+s+")?$",u="^("+i+")?"+s+i+s+i,h="^("+i+")?"+n;return function(r){var s,l,p,c,d,f,m;if(3>r.length)return r;if(p=r.substr(0,1),"y"==p&&(r=p.toUpperCase()+r.substr(1)),c=/^(.+?)(ss|i)es$/,d=/^(.+?)([^s])s$/,c.test(r)?r=r.replace(c,"$1$2"):d.test(r)&&(r=r.replace(d,"$1$2")),c=/^(.+?)eed$/,d=/^(.+?)(ed|ing)$/,c.test(r)){var y=c.exec(r);c=RegExp(o),c.test(y[1])&&(c=/.$/,r=r.replace(c,""))}else if(d.test(r)){var y=d.exec(r);s=y[1],d=RegExp(h),d.test(s)&&(r=s,d=/(at|bl|iz)$/,f=RegExp("([^aeiouylsz])\\1$"),m=RegExp("^"+i+n+"[^aeiouwxy]$"),d.test(r)?r+="e":f.test(r)?(c=/.$/,r=r.replace(c,"")):m.test(r)&&(r+="e"))}if(c=/^(.+?)y$/,c.test(r)){var y=c.exec(r);s=y[1],c=RegExp(h),c.test(s)&&(r=s+"i")}if(c=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,c.test(r)){var y=c.exec(r);s=y[1],l=y[2],c=RegExp(o),c.test(s)&&(r=s+t[l])}if(c=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,c.test(r)){var y=c.exec(r);s=y[1],l=y[2],c=RegExp(o),c.test(s)&&(r=s+e[l])}if(c=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,d=/^(.+?)(s|t)(ion)$/,c.test(r)){var y=c.exec(r);s=y[1],c=RegExp(u),c.test(s)&&(r=s)}else if(d.test(r)){var y=d.exec(r);s=y[1]+y[2],d=RegExp(u),d.test(s)&&(r=s)}if(c=/^(.+?)e$/,c.test(r)){var y=c.exec(r);s=y[1],c=RegExp(u),d=RegExp(a),f=RegExp("^"+i+n+"[^aeiouwxy]$"),(c.test(s)||d.test(s)&&!f.test(s))&&(r=s)}return c=/ll$/,d=RegExp(u),c.test(r)&&d.test(r)&&(c=/.$/,r=r.replace(c,"")),"y"==p&&(r=p.toLowerCase()+r.substr(1)),r}}(),lunr.Pipeline.registerFunction(lunr.stemmer,"stemmer"),lunr.stopWordFilter=function(t){return-1===lunr.stopWordFilter.stopWords.indexOf(t)?t:void 0},lunr.stopWordFilter.stopWords=new lunr.SortedSet,lunr.stopWordFilter.stopWords.length=119,lunr.stopWordFilter.stopWords.elements=["","a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"],lunr.Pipeline.registerFunction(lunr.stopWordFilter,"stopWordFilter"),lunr.TokenStore=function(){this.root={docs:{}},this.length=0},lunr.TokenStore.load=function(t){var e=new this;return e.root=t.root,e.length=t.length,e},lunr.TokenStore.prototype.add=function(t,e,r){var r=r||this.root,n=t[0],i=t.slice(1);return n in r||(r[n]={docs:{}}),0===i.length?(r[n].docs[e.ref]=e,void(this.length+=1)):this.add(i,e,r[n])},lunr.TokenStore.prototype.has=function(t){if(!t)return!1;for(var e=this.root,r=0;t.length>r;r++){if(!e[t[r]])return!1;e=e[t[r]]}return!0},lunr.TokenStore.prototype.getNode=function(t){if(!t)return{};for(var e=this.root,r=0;t.length>r;r++){if(!e[t[r]])return{};e=e[t[r]]}return e},lunr.TokenStore.prototype.get=function(t,e){return this.getNode(t,e).docs||{}},lunr.TokenStore.prototype.count=function(t,e){return Object.keys(this.get(t,e)).length},lunr.TokenStore.prototype.remove=function(t,e){if(t){for(var r=this.root,n=0;t.length>n;n++){if(!(t[n]in r))return;r=r[t[n]]}delete r.docs[e]}},lunr.TokenStore.prototype.expand=function(t,e){var r=this.getNode(t),n=r.docs||{},e=e||[];return Object.keys(n).length&&e.push(t),Object.keys(r).forEach(function(r){"docs"!==r&&e.concat(this.expand(t+r,e))},this),e},lunr.TokenStore.prototype.toJSON=function(){return{root:this.root,length:this.length}},function(t){var e=function(t){var e,r=Array.prototype.slice;return function(){var n=r.call(arguments),i=this;clearTimeout(e),e=setTimeout(function(){t.apply(i,n)},100)}},r=function(t){var e=t.match(/(\d+)/g);return new Date(e[0],e[1]-1,e[2])},n=function(){function n(e,r){this.$elem=e,this.$results=t(r.results),this.$entries=t(r.entries,this.$results),this.indexDataUrl=r.indexUrl,this.template=this.compileTemplate(t(r.template)),this.initialize()}return n.prototype.initialize=function(){var e=this;this.loadIndexData(function(r){e.entries=t.map(r.docs,e.createEntry),e.index=lunr.Index.load(r.index),e.populateSearchFromQuery(),e.bindKeypress()})},n.prototype.compileTemplate=function(t){var e=t.text();return Mustache.parse(e),function(t,r){return Mustache.render(e,t,r)}},n.prototype.loadIndexData=function(e){t.getJSON(this.indexDataUrl,e)},n.prototype.createEntry=function(e,n){var i=t.extend({id:n+1},e);return e.date&&t.extend(i,{date:r(e.date),pubdate:function(){return dateFormat(r(e.date),"yyyy-mm-dd")},displaydate:function(){return dateFormat(r(e.date),"mmm dd, yyyy")}}),i},n.prototype.bindKeypress=function(){var t=this,r=this.$elem.val();this.$elem.bind("keyup",e(function(){var e=t.$elem.val();e!==r&&t.search(e),r=e}))},n.prototype.search=function(e){var r=this.entries;if(e.length<3)this.$results.hide(),this.$entries.empty();else{var n=t.map(this.index.search(e),function(e){return t.grep(r,function(t){return t.id===parseInt(e.ref,10)})[0]});this.displayResults(n)}},n.prototype.displayResults=function(t){var e=this.$entries,r=this.$results;e.empty(),e.append(0===t.length?"<p>Nothing found.</p>":this.template({entries:t})),r.show()},n.prototype.populateSearchFromQuery=function(){var t=new URI(window.location.search.toString()),e=t.search(!0);e.hasOwnProperty("q")&&(this.$elem.val(e.q),this.search(e.q.toString()))},n}();t.fn.lunrSearch=function(e){return e=t.extend({},t.fn.lunrSearch.defaults,e),new n(this,e),this},t.fn.lunrSearch.defaults={indexUrl:"/js/index.json",results:"#search-results",entries:".entries",template:"#search-results-template"}}(jQuery);
//# sourceMappingURL=search.js.map